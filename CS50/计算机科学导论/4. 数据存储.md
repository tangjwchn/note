# 4. 数据存储
计算机是一个可编程的数据处理机器。在谈论处理数据之前，我们需要理解数据的特性。

## 4.1 数据类型
如今，数据以不同的形式出现，如数字、文本、音频、图像和视频。

人们需要能够处理许多不同的数据类型：
* 工程程序使用计算机的主要目的是处理数字：进行算术运算、求解代数或三角方程、找出微分方程的根等。
* 与工程程序不同的是，文字处理程序使用计算机的主要目的是处理文本：调整对其、移动、删除等。
* 计算机同样也处理音频数据。我们可以使用计算机播放音乐，并且可以把声音作为数据输入到计算机中。
* 图像处理程序使用计算机的主要目的是处理图像：创建、收缩、放大、旋转等。
* 最后，计算机不仅能用来播放电影，还能创建我们在电影中所看到的特技效果。

**计算机行业中使用术语“多媒体“来定义包含数字、文本、图像、音频和视频的信息。**

### 4.1.1 计算机内部的数据
所有计算机外部的数据类型的数据都采用统一的数据表示法转换后存入计算机中，当数据从计算机输出时再还原回来。这种通用的格式称为位模式。

**1. 位**  
位（bit，binary digit 的缩写）是存储在计算机中的最小单位，它是 0 或 1。位代表设备的某一状态，这些设备只能处于两种状态之一。例如，开关要么合上要么断开。用 1 表示合上状态，0 表示断开状态。

**2. 位模式**  
为了表示数据的不同类型，应该使用位模式，它是一个序列（位模式：1000101011111101），由 0 和 1 组成。这就意味着，如果我们需要存储一个由 16 个位组成的位模式，那么需要 16 个电子开关。如果我们需要存储 1000 个位模式，每个 16 位，那么需要 16000 个开关。

通常长度为 8 的位模式被称为 1 字节。

## 4.2 存储数字
在存储到计算机内存中之前，数字会被转换到二进制系统。

### 4.2.1 存储整数
整数可以被当作小数点位置固定的数字：小数点固定在最右边。因此，定位表示法用于存储整数。在这种表示法中，小数点是假定的，但并不存储。

为了更有效地利用计算机内存，无符号和有符号的整数在计算机中的存储方式是不同的。

**1. 无符号表示法**  
无符号整数是只包括零和正数的非负整数。它的范围介于 0 到无穷大之间。然而，由于计算机不可能表示这个范围的所有整数，通常计算机都定义了一个常量，称为最大无符号整数，它的值是
$(2^n - 1)$ 。这里 $n$ 就是计算机中分配用于表示无符号整数的二进制位数。

输入设备使用以下步骤存储无符号整数：  
1、首先将整数变成二进制数。  
2、如果二进制位数不足 $n$ 位，则在二进制数的左边补 0，使它的总位数为 $n$ 位。如果位数大于 $n$ ，该整数无法存储。这会导致溢出情况发生。

**2. 有符号表示法**
几乎所有的计算机都使用二进制补码表示法来存储位于 $n$ 位存储单元中的有符号整数。这一方法中，无符号整数的有效范围（ 0 到 $2^n - 1$ ）被分为两个相等的子范围。第一个子范围用来表示非负整数，第二子范围用来表示负整数。

首位（最左位）决定符号，如果最左位是 0 ，该整数非负；如果最左位是 1，该整数是负数。

例如，如果 n 是 4 ，该范围是 0000 到 1111。这个范围分为两半：0000 到 0111 表示非负数，1000 到 1111 表示负数。

### 4.2.2 两种运算
**1. 反码**  
该运算可以应用于任何整数，无论是正的还是负的。该运算简单反转各个位，即把 0 位变为 1 位，把 1 位变为 0 位。

**2. 补码**  
将整数进行补码运算的方法是先对它进行 1 次反码运算再加上 1 得到结果。

以二进制补码格式存储整数，计算机遵循以下步骤：
1. 将整数变成 n 位的二进制数。
2. 如果整数是正数或零，以其原样存储；如果是负数，计算机取其补码存储。

以二进制补码格式还原整数，计算机遵循以下步骤：
1. 如果最左位是 1，计算机取其补码。如果最左位是 0，计算机不进行操作。
2. 计算机将该整数转换为十进制。

### 4.2.3 实数
实数是带有整数部分和小数部分的数字。

**1. 浮点表示法**  
用于维持精度的解决方法是使用浮点表示法。该表示法允许小数点浮动：我们可以在小数点的左右有不同数量的数码。使用这种方法极大地增加了可存储的实数范围：带有很大的整数部分或很小的小数部分的实数可以存储在内存中。在浮点表示法中，无论十进制还是二进制，一个数字都由 3 部分组成，第一部分是符号，可正可负。第二部分显示小数点应该左右移动构成实际数字的位移量。第三部分是小数点位置固定的定点表示法。

示例：下面演示用科学计数法（浮点表示法）表示十进制数 7 425 000 000 000 000 000 000.00。  
解  
实际数字           -> + 7 425 000 000 000 000 000 000.00  
科学计数法       -> + 7.425 * $10^{21}$

### 4.2.4 IEEE 标准
电气和电子工程师协会（IEEE）已定义了几种存储浮点数的标准。这里我们讨论其中两种最常用的 - 单精度和双精度。

单精度（32位）：符号位 S（1） + 指数（8） + 尾数（23）  
双精度（64位）：符号位 S（1） + 指数（11）+ 尾数（52）

单精度数格式采用总共 32 位来存储一个浮点表示法的实数。符号占用 1 位（0 为正，1为负），指数占用 8 位（使用偏移量 127），尾数使用23位（无符号数）。  
双精度数格式采用总共 64 位来存储一个浮点表示法的实数。符号占用 1 位（0 为正，1为负），指数占用 11 位（使用偏移量 1023），尾数使用23位（无符号数）。

## 4.3 存储文本
在任何语言中，文本的片段是用来表示该语言中某个意思的一系列的符号。例如，在英语中使用 26 个符号（A,B,C,···,Z）来表示大写字母，26个符号（a,b,c,···,z）表示小写字母，10个符号（0,1,2,···,9）来表示数字字符，以及符号（.,?,:,;,···,!）来表示标点。另外一些符号（如空格、换行和制表符）被用于文本的对齐和可读性。

我们可用位模式来表示任何一个符号，示例：  
C：1000011  
A：1000001  
T：1010100  
S：1010011  

### 4.3.1 代码
不同的位模式集合被设计用于表示文本符号。其中每一个集合我们称之为代码。表示符号的过程被称为编码。

**1. ASCII**  
美国国家标准协会（ANSI）开发了一个被称为美国信息交换标准码（ASCII）的代码。该代码使用 7 位表示每个符号，即该代码可以定义 $2^7 = 128$ 种不同的符号。